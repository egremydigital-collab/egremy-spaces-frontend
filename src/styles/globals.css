@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  * {
    @apply border-bg-tertiary;
  }
  
  body {
    @apply bg-bg-primary text-text-primary font-sans;
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-bg-primary;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-bg-tertiary rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-text-secondary;
  }

  /* Focus styles */
  *:focus-visible {
    @apply outline-none ring-2 ring-accent-primary ring-offset-2 ring-offset-bg-primary;
  }
}

@layer components {
  /* Card base */
  .card {
    @apply bg-bg-secondary border border-bg-tertiary rounded-lg;
  }

  /* Input base */
  .input-base {
    @apply w-full px-3 py-2 bg-bg-tertiary border border-bg-tertiary rounded-lg
           text-text-primary placeholder:text-text-secondary
           focus:border-accent-primary focus:ring-1 focus:ring-accent-primary
           transition-colors duration-200;
  }

  /* Button variants */
  .btn {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2
           font-medium rounded-lg transition-all duration-200
           disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .btn-primary {
    @apply btn bg-accent-primary text-white hover:bg-accent-primary/90;
  }

  .btn-secondary {
    @apply btn bg-bg-tertiary text-text-primary hover:bg-bg-tertiary/80;
  }

  .btn-ghost {
    @apply btn bg-transparent text-text-secondary hover:bg-bg-tertiary hover:text-text-primary;
  }

  .btn-danger {
    @apply btn bg-accent-danger text-white hover:bg-accent-danger/90;
  }

  .btn-success {
    @apply btn bg-accent-success text-white hover:bg-accent-success/90;
  }

  /* Status badges */
  .badge {
    @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
  }

  .badge-discovery { @apply bg-status-discovery/20 text-status-discovery; }
  .badge-design { @apply bg-status-design/20 text-status-design; }
  .badge-build { @apply bg-status-build/20 text-status-build; }
  .badge-qa { @apply bg-status-qa/20 text-status-qa; }
  .badge-deploy { @apply bg-status-deploy/20 text-status-deploy; }
  .badge-live { @apply bg-status-live/20 text-status-live; }
  .badge-optimization { @apply bg-status-optimization/20 text-status-optimization; }
  .badge-blocked { @apply bg-status-blocked/20 text-status-blocked; }
  .badge-needs_client_approval { @apply bg-status-approval/20 text-status-approval; }
  .badge-bug { @apply bg-status-bug/20 text-status-bug; }
  .badge-hotfix { @apply bg-status-hotfix/20 text-status-hotfix; }
}

@layer utilities {
  /* Animation utilities */
  .animate-in {
    animation: fadeIn 0.2s ease-out;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-4px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Text utilities */
  .text-balance {
    text-wrap: balance;
  }
}

/* =========================================
   Egremy Gantt Dark Theme (gantt-task-react)
   Override completo de estilos default blancos
   NOTA: Aplicado a .eg-gantt-wrap (sin wrapper extra)
   ========================================= */

/* ============================================
   WRAPPER Y ESTRUCTURA
   ============================================ */

.eg-gantt-wrap {
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 16px;
  overflow: hidden;
  background: 
    radial-gradient(ellipse 1200px 400px at 10% 0%, rgba(99, 102, 241, 0.08), transparent 50%),
    radial-gradient(ellipse 800px 300px at 90% 100%, rgba(34, 242, 196, 0.06), transparent 50%),
    rgba(2, 6, 23, 0.65);
  box-shadow: 
    0 0 0 1px rgba(34, 242, 196, 0.05),
    0 20px 60px rgba(0, 0, 0, 0.45);
}

/* ============================================
   TOOLBAR
   ============================================ */

.eg-gantt-toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 16px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.06);
  background: linear-gradient(
    180deg,
    rgba(15, 15, 35, 0.9) 0%,
    rgba(2, 6, 23, 0.8) 100%
  );
  flex-wrap: wrap;
}

.eg-gantt-toolbar-left {
  display: flex;
  gap: 6px;
}

.eg-gantt-toolbar-right {
  display: flex;
  align-items: center;
  gap: 16px;
}

.eg-gantt-pill {
  appearance: none;
  border: 1px solid rgba(255, 255, 255, 0.10);
  background: rgba(255, 255, 255, 0.03);
  color: rgba(255, 255, 255, 0.75);
  padding: 8px 16px;
  border-radius: 999px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.eg-gantt-pill:hover {
  background: rgba(255, 255, 255, 0.06);
  color: rgba(255, 255, 255, 0.9);
}

.eg-gantt-pill.is-active {
  border-color: rgba(99, 102, 241, 0.5);
  background: rgba(99, 102, 241, 0.15);
  color: rgba(255, 255, 255, 0.95);
  box-shadow: 0 0 20px rgba(99, 102, 241, 0.2);
}

/* ============================================
   LEGEND
   ============================================ */

.eg-gantt-legend {
  display: flex;
  gap: 16px;
  font-size: 12px;
  color: rgba(255, 255, 255, 0.6);
}

.eg-gantt-legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
}

/* FIXED: Legend dot con clases específicas para cada color */
/* Esto evita que las reglas globales con !important lo sobrescriban */
.eg-gantt-legend-dot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  display: inline-block;
  animation: legendPulse 2.5s ease-in-out infinite;
}

/* Colores específicos - usando !important para ganar especificidad */
.eg-gantt-legend-dot.eg-gantt-legend-dot--live {
  background-color: #22f2c4 !important;
  box-shadow: 0 0 8px #22f2c4, 0 0 14px #22f2c4 !important;
}

.eg-gantt-legend-dot.eg-gantt-legend-dot--build {
  background-color: #3b82f6 !important;
  box-shadow: 0 0 8px #3b82f6, 0 0 14px #3b82f6 !important;
}

.eg-gantt-legend-dot.eg-gantt-legend-dot--approval {
  background-color: #f59e0b !important;
  box-shadow: 0 0 8px #f59e0b, 0 0 14px #f59e0b !important;
}

.eg-gantt-legend-dot.eg-gantt-legend-dot--blocked {
  background-color: #ef4444 !important;
  box-shadow: 0 0 8px #ef4444, 0 0 14px #ef4444 !important;
}

@keyframes legendPulse {
  0%, 100% { opacity: 0.82; transform: scale(1); }
  50%      { opacity: 1;    transform: scale(1.07); }
}

/* ============================================
   OVERRIDE GANTT-TASK-REACT - FONDOS
   Aplicados directamente a .eg-gantt-wrap
   ============================================ */

/* Contenedor principal del gantt */
.eg-gantt-wrap > div {
  background: transparent !important;
}

/* Tabla de tareas (sidebar izquierdo) - OCULTO via React props */
/* TaskListHeader y TaskListTable se renderizan como null en el componente */
/* Ya no necesitamos hacks CSS aquí */

/* Forzar el fondo dark en TODO el gantt incluyendo el calendario */
/* EXCLUIR legend-dot del transparent */
.eg-gantt-wrap [class*="gantt"]:not(.eg-gantt-legend-dot):not([class*="legend"]),
.eg-gantt-wrap [class*="calendar"],
.eg-gantt-wrap [class*="grid"] {
  background: transparent !important;
}

/* Forzar fondo oscuro en divs internos */
.eg-gantt-wrap > div > div {
  background: rgba(10, 10, 25, 0.95) !important;
}

/* ============================================
   FORZAR DARK EN TODA EL ÁREA DEL CALENDARIO
   ============================================ */

/* Fondo del área principal del gantt - MUY IMPORTANTE */
/* EXCLUIR el legend-dot para que su background inline funcione */
.eg-gantt-wrap div[class]:not(.eg-gantt-legend-dot) {
  background-color: rgba(10, 10, 25, 0.98) !important;
}

/* Excepciones - elementos que NO deben tener fondo oscuro */
.eg-gantt-wrap .eg-gantt-toolbar,
.eg-gantt-wrap .eg-gantt-pill,
.eg-gantt-wrap svg,
.eg-gantt-wrap svg *,
.eg-gantt-wrap [class*="tooltip"],
.eg-gantt-wrap [class*="Tooltip"] {
  background-color: transparent !important;
}

/* Re-aplicar el fondo del toolbar */
.eg-gantt-toolbar {
  background: linear-gradient(
    180deg,
    rgba(15, 15, 35, 0.9) 0%,
    rgba(2, 6, 23, 0.8) 100%
  ) !important;
}

/* Header del calendario con los meses - NEGRO para fondo claro */
.eg-gantt-wrap [class*="calendarTop"] text,
.eg-gantt-wrap [class*="calendarBottom"] text,
.eg-gantt-wrap [class*="calendar"] text {
  fill: #0b1220 !important;
  font-weight: 500 !important;
}

/* OVERRIDE CRÍTICO: Asegurar que TODO texto SVG sea negro */
/* Excepto los labels de las barras que van en blanco */
.eg-gantt-wrap svg text:not([class*="barLabel"]):not(._3zRJQ) {
  fill: #0b1220 !important;
}

/* Todos los textos del SVG del calendario - NEGRO */
.eg-gantt-wrap svg text {
  fill: rgba(30, 30, 50, 0.8) !important;
  font-family: Inter, system-ui, sans-serif !important;
}

/* Grid principal */
.eg-gantt-wrap ._1nBOt,
.eg-gantt-wrap ._2dZTy,
.eg-gantt-wrap [class*="gridBody"],
.eg-gantt-wrap [class*="ganttTable"] {
  background: transparent !important;
}

/* SVG background */
.eg-gantt-wrap svg {
  background: transparent !important;
}

/* Filas del grid - alternar sutilmente */
.eg-gantt-wrap ._WuQ0f,
.eg-gantt-wrap [class*="gridRow"] {
  fill: rgba(255, 255, 255, 0.015) !important;
}

.eg-gantt-wrap ._WuQ0f:nth-child(even),
.eg-gantt-wrap [class*="gridRow"]:nth-child(even) {
  fill: rgba(255, 255, 255, 0.03) !important;
}

/* ============================================
   OVERRIDE GANTT-TASK-REACT - HEADER
   ============================================ */

.eg-gantt-wrap ._2q1Kt,
.eg-gantt-wrap [class*="calendarHeader"],
.eg-gantt-wrap [class*="ganttHeader"] {
  background: rgba(10, 10, 30, 0.9) !important;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08) !important;
}

/* Texto del header */
.eg-gantt-wrap ._2q1Kt text,
.eg-gantt-wrap [class*="calendarHeader"] text,
.eg-gantt-wrap text[class*="calendar"] {
  fill: rgba(255, 255, 255, 0.7) !important;
  font-family: Inter, system-ui, sans-serif !important;
  font-weight: 500 !important;
}

/* Líneas del header */
.eg-gantt-wrap ._2q1Kt line,
.eg-gantt-wrap [class*="calendarHeader"] line {
  stroke: rgba(255, 255, 255, 0.08) !important;
}

/* ============================================
   OVERRIDE GANTT-TASK-REACT - GRID LINES
   ============================================ */

.eg-gantt-wrap line {
  stroke: rgba(255, 255, 255, 0.06) !important;
}

.eg-gantt-wrap ._34SS0,
.eg-gantt-wrap [class*="tick"] line {
  stroke: rgba(255, 255, 255, 0.04) !important;
}

/* ============================================
   OVERRIDE GANTT-TASK-REACT - TODAY MARKER
   ============================================ */

.eg-gantt-wrap ._9w8d5,
.eg-gantt-wrap [class*="today"],
.eg-gantt-wrap rect[class*="today"] {
  fill: rgba(34, 242, 196, 0.22) !important;
}

/* ============================================
   OVERRIDE GANTT-TASK-REACT - BARRAS
   ============================================ */

/* Barras principales */
.eg-gantt-wrap ._3T42e rect,
.eg-gantt-wrap [class*="barWrapper"] rect,
.eg-gantt-wrap [class*="barBackground"] {
  rx: 8 !important;
  ry: 8 !important;
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.4));
  cursor: pointer;
}

/* Progress bar */
.eg-gantt-wrap ._1KJ6x,
.eg-gantt-wrap [class*="barProgress"] {
  rx: 8 !important;
  ry: 8 !important;
}

/* Labels de las barras */
.eg-gantt-wrap ._3zRJQ,
.eg-gantt-wrap [class*="barLabel"] {
  fill: rgba(255, 255, 255, 0.95) !important;
  font-family: Inter, system-ui, sans-serif !important;
  font-weight: 600 !important;
  font-size: 12px !important;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

/* Hover en barras - Glow verde Egremy */
.eg-gantt-wrap ._3T42e:hover rect,
.eg-gantt-wrap [class*="barWrapper"]:hover rect,
.eg-gantt-wrap svg rect[rx]:hover {
  filter: drop-shadow(0 0 8px rgba(34, 242, 196, 0.55))
          drop-shadow(0 0 18px rgba(34, 242, 196, 0.25)) !important;
  cursor: pointer;
}

/* ============================================
   OVERRIDE GANTT-TASK-REACT - HANDLES (DRAG)
   ============================================ */

.eg-gantt-wrap ._KxSXS,
.eg-gantt-wrap [class*="handleGroup"] rect {
  fill: rgba(255, 255, 255, 0.3) !important;
  rx: 4 !important;
  ry: 4 !important;
}

.eg-gantt-wrap ._KxSXS:hover,
.eg-gantt-wrap [class*="handleGroup"]:hover rect {
  fill: rgba(255, 255, 255, 0.5) !important;
}

/* ============================================
   OVERRIDE GANTT-TASK-REACT - ARROWS
   ============================================ */

.eg-gantt-wrap path[class*="arrow"],
.eg-gantt-wrap ._2rSRQ {
  stroke: rgba(255, 255, 255, 0.25) !important;
  fill: none !important;
}

/* ============================================
   OVERRIDE - TEXTOS DEL CALENDARIO EN NEGRO
   ============================================ */

/* Texto de los meses y semanas - NEGRO para fondo claro */
/* MÁXIMA ESPECIFICIDAD para sobrescribir cualquier otro estilo */
.eg-gantt-wrap svg text,
.eg-gantt-wrap svg text[fill],
.eg-gantt-wrap svg > g text,
.eg-gantt-wrap svg g g text {
  fill: #0b1220 !important;
  font-family: Inter, system-ui, sans-serif !important;
}

/* Labels de las barras - BLANCO (están sobre barras de color) */
.eg-gantt-wrap ._3zRJQ,
.eg-gantt-wrap [class*="barLabel"],
.eg-gantt-wrap svg text[class*="bar"] {
  fill: rgba(255, 255, 255, 0.95) !important;
  font-weight: 600 !important;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

/* Cualquier rect blanco - dejarlo como está (no oscurecer) */
/* Solo ocultar los que son parte del sidebar */

/* Textos negros en el calendario (para fondo claro) */
.eg-gantt-wrap text[fill="#000"],
.eg-gantt-wrap text[fill="#333"],
.eg-gantt-wrap text[fill="black"],
.eg-gantt-wrap text[fill="rgb(0, 0, 0)"] {
  fill: rgba(30, 30, 50, 0.9) !important;
}

/* Líneas grises a sutiles */
.eg-gantt-wrap line[stroke="#e0e0e0"],
.eg-gantt-wrap line[stroke="#ebebeb"],
.eg-gantt-wrap line[stroke="rgb(224, 224, 224)"] {
  stroke: rgba(255, 255, 255, 0.06) !important;
}

/* ============================================
   TOOLTIP - Estilo Glassmorphism Egremy
   ============================================ */

/* Tooltip custom de nuestro componente */
.eg-gantt-tooltip {
  background: rgba(15, 20, 35, 0.88) !important;
  backdrop-filter: blur(20px) !important;
  -webkit-backdrop-filter: blur(20px) !important;
  border: 1px solid rgba(34, 242, 196, 0.35) !important;
  border-radius: 14px !important;
  padding: 16px 20px !important;
  box-shadow: 
    0 0 0 1px rgba(34, 242, 196, 0.12),
    0 10px 30px rgba(0, 0, 0, 0.45),
    0 0 18px rgba(34, 242, 196, 0.22) !important;
  min-width: 200px;
}

.eg-gantt-tooltip-title {
  color: rgba(255, 255, 255, 0.95) !important;
  font-weight: 600;
  font-size: 15px;
  margin-bottom: 10px;
  line-height: 1.3;
}

.eg-gantt-tooltip-dates {
  display: flex;
  align-items: center;
  gap: 10px;
  color: rgba(255, 255, 255, 0.7) !important;
  font-size: 13px;
  margin-bottom: 4px;
}

.eg-gantt-tooltip-arrow {
  color: rgba(99, 102, 241, 0.8) !important;
}

.eg-gantt-tooltip-progress {
  margin-top: 12px;
  padding-top: 10px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  color: #22f2c4 !important;
  font-size: 13px;
  font-weight: 600;
}

/* FORZAR estilo en CUALQUIER tooltip de gantt-task-react */
.eg-gantt-wrap [class*="tooltip"],
.eg-gantt-wrap [class*="Tooltip"],
[class*="gantt"] [class*="tooltip"],
[class*="gantt"] [class*="Tooltip"],
.eg-gantt-wrap [role="tooltip"] {
  background: rgba(15, 20, 35, 0.88) !important;
  background-color: rgba(15, 20, 35, 0.88) !important;
  backdrop-filter: blur(20px) !important;
  -webkit-backdrop-filter: blur(20px) !important;
  color: rgba(255, 255, 255, 0.95) !important;
  border: 1px solid rgba(34, 242, 196, 0.35) !important;
  border-radius: 14px !important;
  box-shadow: 
    0 0 0 1px rgba(34, 242, 196, 0.12),
    0 10px 30px rgba(0, 0, 0, 0.45),
    0 0 18px rgba(34, 242, 196, 0.22) !important;
}

/* Forzar texto blanco en tooltips */
.eg-gantt-wrap [class*="tooltip"] *,
.eg-gantt-wrap [class*="Tooltip"] *,
[class*="gantt"] [class*="tooltip"] *,
[class*="gantt"] [class*="Tooltip"] * {
  color: rgba(255, 255, 255, 0.9) !important;
}

/* ============================================
   EMPTY STATE
   ============================================ */

.eg-gantt-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 80px 20px;
  text-align: center;
  min-height: 350px;
  background: 
    radial-gradient(ellipse 600px 300px at 50% 50%, rgba(99, 102, 241, 0.06), transparent 70%);
}

.eg-gantt-empty-icon {
  font-size: 56px;
  margin-bottom: 20px;
  filter: grayscale(0.3);
}

.eg-gantt-empty-title {
  font-size: 18px;
  font-weight: 600;
  color: rgba(255, 255, 255, 0.85);
  margin: 0 0 10px 0;
}

.eg-gantt-empty-subtitle {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.5);
  margin: 0;
  max-width: 320px;
  line-height: 1.5;
}

/* ============================================
   SCROLLBAR DARK
   ============================================ */

.eg-gantt-wrap::-webkit-scrollbar,
.eg-gantt-wrap *::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

.eg-gantt-wrap::-webkit-scrollbar-track,
.eg-gantt-wrap *::-webkit-scrollbar-track {
  background: rgba(5, 5, 15, 0.8);
}

.eg-gantt-wrap::-webkit-scrollbar-thumb,
.eg-gantt-wrap *::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.12);
  border-radius: 5px;
  border: 2px solid rgba(5, 5, 15, 0.8);
}

.eg-gantt-wrap::-webkit-scrollbar-thumb:hover,
.eg-gantt-wrap *::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.2);
}

.eg-gantt-wrap::-webkit-scrollbar-corner,
.eg-gantt-wrap *::-webkit-scrollbar-corner {
  background: rgba(5, 5, 15, 0.8);
}

/* ============================================
   RESPONSIVE
   ============================================ */

@media (max-width: 768px) {
  .eg-gantt-toolbar {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
  
  .eg-gantt-legend {
    flex-wrap: wrap;
    gap: 10px;
  }
  
  .eg-gantt-pill {
    padding: 6px 12px;
    font-size: 12px;
  }
}
